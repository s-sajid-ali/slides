\mode<presentation>

% Make a new metadata field for the title page
\newcommand{\insertcoverphoto}{graphics/anl-aerial.jpg}
\newcommand{\coverphoto}[1]{\renewcommand{\insertcoverphoto}{#1}}

% Put slide numbers on the bottom
\beamertemplatenavigationsymbolsempty
\setbeamertemplate{navigation symbols}{}
%% \addtobeamertemplate{navigation symbols}{}{%
\addtobeamertemplate{footline}{}{%
  \ifnum\thepage>1\relax%
  \vspace{-2.5ex}%
    \usebeamerfont{footline}%
    \usebeamercolor[fg]{footline}%
    \leavevmode%
    \begin{beamercolorbox}[wd=\paperwidth,ht=2.75ex,dp=1.5ex,center,rightskip=1em]{pagenums}%
      \centering
        \insertframenumber/\inserttotalframenumber%
    \end{beamercolorbox}%
    \fi%
}

\newlength{\titlebarheight}
\setlength{\titlebarheight}{0.39\paperheight}
\newlength{\subtitlewidth}
\setlength{\subtitlewidth}{\paperwidth}
\addtolength{\subtitlewidth}{-6.0cm}
\newlength{\titlewidth}
\setlength{\titlewidth}{0.55\paperwidth}
\newlength{\datewidth}
\setlength{\datewidth}{\paperwidth}
\addtolength{\datewidth}{-7.5cm}
  
\setbeamertemplate{background}{
  \begin{tikzpicture}
    \useasboundingbox (0,0) rectangle(\the\paperwidth,\the\paperheight);
    %% Prepare the titleslide
    \ifnum\thepage<2\relax%
    %% Create the colored boxes across the title slide
    \fill[color=anlgreen] (0,0.72\paperheight-\titlebarheight) rectangle (0.4cm,0.72\paperheight);
    \fill[color=anlblue] (0.4cm,0.72\paperheight-\titlebarheight) rectangle (\paperwidth,0.72\paperheight);
    %% ANL Logo to the upper right corner
    \node[inner sep=0pt,anchor=east] (anllogo) at (\paperwidth-0.35cm,\paperheight-1.4cm) {\includegraphics[width=4.5cm]{logos/ANL_CMYK.pdf}};
    %% Accent image (default is argonne photo
    \node[inner sep=0pt,anchor=north east,align=right] (photo) at (\paperwidth, 0.72\paperheight) {\includegraphics[height=\titlebarheight]{\insertcoverphoto}};
    %%     \ifdefined\@coverphoto%
    %%     \@coverphoto%
    %%     %% Hello%% \@coverphoto
    %%     %% \else%
    %%     graphics/anl-aerial.jpg%
    %%     \fi%
    %% }};
    %% }; % graphics/anl-aerial.jpg
    %% Add DOE logo and disclaimer to the lower left corner
    \node[anchor=east] (doelogo) at (3cm, 0.5cm) {%
      \includegraphics[width=2.5cm]{logos/DOE_logo_black.pdf}};
    \node[anchor=west,text width=2.8cm] (doetext) at (2.8cm, 0.5cm) {%
      \fontsize{4pt}{5pt}\selectfont
      Argonne National Laboratory is a U.S.\ Department of Energy
      laboratory managed by UChicago Argonne, LLC.\par};
    \fi%

    %% Prepare all the other (non-title) slides
    \ifnum\thepage>1\relax%
    \fill[color=anlgreen] (0,0) rectangle (0.4cm,\paperheight);
    %% Add DOE logo and disclaimer to the lower left corner
    \scalebox{0.4}{%
      \node[anchor=east] (doelogo) at (4.5cm, 0.5cm) {%
        \includegraphics[width=2.5cm]{logos/DOE_logo_black.pdf}};
      \node[anchor=west,text width=2.8cm] (doetext) at (4.3cm, 0.5cm) {%
        \fontsize{4pt}{5pt}\selectfont
        Argonne National Laboratory is a U.S.\ Department of Energy
        laboratory managed by UChicago Argonne, LLC.\par};}
      %% Add ANL logo to lower right-hand corner
    \node[inner sep=0pt,anchor=south east] (anllogo) at (\paperwidth-0.5cm,0.cm) {\includegraphics[width=1.5cm]{logos/ANL_CMYK.pdf}};
    \fi%
    
  \end{tikzpicture}
}

% Title page
\defbeamertemplate*{title page}{anl}[2][]{%
  \begin{tikzpicture}
    \useasboundingbox (28.4pt,0) rectangle(\the\paperwidth,\the\paperheight);
    % Add title to the blue box
    \node[inner sep=0pt,anchor=north west] (title) at (0.4cm,0.72\paperheight) {
      \begin{beamercolorbox}[wd=\titlewidth,leftskip=0cm,sep=8pt,#1]{title page header}
        \usebeamerfont{title}\inserttitle\par%
    \end{beamercolorbox}};
    % Add subtitle to top of title slide
    \node[inner sep=0pt,anchor=west] (subtitle) at (0.4cm,\paperheight-1.4cm) {
      \begin{beamercolorbox}[wd=\subtitlewidth,leftskip=0cm,sep=8pt,#1]{title page subheader}
        \usebeamerfont{subtitle}\insertsubtitle\par%
    \end{beamercolorbox}};
    \node[inner sep=0pt,anchor=west] (subtitle) at (0.4cm,0.28\paperheight) {
      \begin{beamercolorbox}[wd=0.9\paperwidth,leftskip=8pt,sep=8pt,#1]{author}
        \usebeamerfont{author}\insertauthor%
    \end{beamercolorbox}};
    \node[inner sep=0pt,anchor=south west] (subtitle) at (6.5cm,0) {
      \begin{beamercolorbox}[wd=\datewidth,leftskip=8pt,sep=8pt,#1]{date}
        \usebeamerfont{date}\insertdate%
      \end{beamercolorbox}};
  \end{tikzpicture}
}

\mode
<all>
